<table width="100%">
  <tr>
    <td>
      <form id="lps-pkgls-s6r-qry" action="#" class="form-inlines">
        <input id="lps-pkgls-s6r-qry-name" type="hidden" value="">
        <input id="lps-pkgls-s6r-qry-text" type="text"
          class="form-control lps-toolbar-qry-input" 
          placeholder="Press Enter to Search" 
          value="">
      </form>
    </td>
  </tr>
</table>

<table class="table table-hover">
  <thead>
    <tr>
      <th>Name</th>
      <th>Version</th>
      <th>Release</th>
      <th>OS/Arch</th>
      <th>
        <div id="lps-pkgls-s6r-chans" class="dropdown">Channels</div>
      </th>
      <th></th>
    </tr>
  </thead>

  <tbody id="lps-pkgls-s6r"></tbody>

</table>

<div id="lps-pkgls-s6r-empty-alert" class="alert alert-warning hide">No more results ...</div>

<script id="lps-pkgls-s6r-tpl" type="text/html">
{[~it.items :v]}
<tr>
  <td style="width:35%;">{[=v.meta.name]}</td>
  <td style="width:20%;">{[=v.version]}</td>
  <td>{[=v.release]}</td>
  <td class="lps-font-mono">{[=v.pkg_os]}.{[=v.pkg_arch]}</td>
  <td>
    {[~it.channels :cv]}
    {[if (cv.meta.id == v.channel) {]}
      {[=cv.meta.name]}
    {[}]}
    {[~]}
  </td>
  <td align="right">
    <button class="btn btn-default btn-xs" onclick="_lps_pkgls_select_pkg('{[=v.meta.id]}')">Select</button>
  </td>
</tr>
{[~]}
</script>

<script id="lps-pkgls-s6r-chans-tpl" type="text/html">
  <a class="dropdown-toggle" data-toggle="dropdown" href="#{[=it.qry_chanid]}">
    <span id="lps-pkgls-qry-chanvalue">{[=it.qry_chanvalue]}</span> <span class="caret"></span>
  </a>  
  <ul class="dropdown-menu">
    <li>
      <a class="chan-item" href="#" label="Channels"
        onclick="_lps_pkgls_chanselect()">
        All Channels
      </a>
    </li>
    {[~it.channels :v]}
    <li>
      <a class="chan-item" href="#{[=v.meta.id]}"
        onclick="_lps_pkgls_chanselect('{[=v.meta.id]}', '{[=v.meta.name]}')">
        {[=v.vendor_name]} / {[=v.meta.name]}
      </a>
    </li>
    {[~]}
  </ul>
</script>

<script type="text/javascript">

$("#lps-pkgls-s6r-qry").submit(function(event) {
    event.preventDefault();
    lpLps.PackageListRefresh("lps-pkgls-s6r");
});

function _lps_pkgls_chanselect(chan_id, chan_value)
{
    if (!chan_id) {
        chan_id = "";
    }
    if (!chan_value) {
        chan_value = "Channels";
    }
    lpLps.pkgls_qry_chanactive = chan_id;
    lpLps.pkgls_qry_chanvalue = chan_value;

    $("#lps-pkgls-s6r-qry-chanvalue").text(chan_value);

    lpLps.PackageListRefresh();
}

function _lps_pkgls_select_pkg(id)
{
    if (l4iModal.CurOptions.fn_selector) {
        l4iModal.CurOptions.fn_selector(null, id);
    }
}

</script>
